<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Finder</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const supabaseUrl = 'YOUR_SUPABASE_PROJECT_URL';
        const supabaseKey = 'YOUR_SUPABASE_API_KEY';
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);
    </script>
    <style>
        /* Add your CSS styles here */
    </style>
</head>
<body>
    <h1>Recipe Finder</h1>
    
    <div>
        <h2>Filter by:</h2>
        <input type="text" id="searchInput" placeholder="Search...">
        
        <select id="mealFilter" multiple>
            <option value="Breakfast">Breakfast</option>
            <option value="Lunch">Lunch</option>
            <option value="Dinner">Dinner</option>
            <option value="Appetizer/Side">Appetizer/Side</option>
            <option value="Dessert">Dessert</option>
            <option value="Bento Box">Bento Box</option>
        </select>
        
        <select id="meatFilter" multiple>
            <option value="Beef">Beef</option>
            <option value="Chicken">Chicken</option>
            <option value="Pork">Pork</option>
            <option value="Turkey">Turkey</option>
            <option value="Sausage">Sausage</option>
            <option value="Bacon">Bacon</option>
            <option value="Spam">Spam</option>
            <option value="Shrimp">Shrimp</option>
            <option value="Tuna">Tuna</option>
            <option value="Salami">Salami</option>
            <option value="Fish">Fish</option>
            <option value="Salmon">Salmon</option>
            <option value="None">None</option>
        </select>
        
        <select id="calorieFilter">
            <option value="">Select Calorie Range</option>
            <option value="0-200">200cal or less</option>
            <option value="201-400">201-400</option>
            <option value="401-600">401-600</option>
            <option value="601+">600+</option>
        </select>
        
        <select id="fatFilter">
            <option value="">Select Fat Range</option>
            <option value="0-10">10g or less</option>
            <option value="11-20">11-20</option>
            <option value="21-30">21-30</option>
            <option value="31-40">31-40</option>
            <option value="41-50">41-50</option>
            <option value="51+">50+</option>
        </select>
        
        <select id="carbFilter">
            <option value="">Select Carb Range</option>
            <option value="0-10">10g or less</option>
            <option value="11-20">11-20</option>
            <option value="21-30">21-30</option>
            <option value="31-40">31-40</option>
            <option value="41-50">41-50</option>
            <option value="51+">50+</option>
        </select>
        
        <select id="proteinFilter">
            <option value="">Select Protein Range</option>
            <option value="0-10">10g or less</option>
            <option value="11-20">11-20</option>
            <option value="21-30">21-30</option>
            <option value="31-40">31-40</option>
            <option value="41-50">41-50</option>
            <option value="51+">50+</option>
        </select>
        
        <select id="timeFilter">
            <option value="">Select Cooking Time Range</option>
            <option value="0-20">0-20</option>
            <option value="21-30">21-30</option>
            <option value="31-40">31-40</option>
            <option value="41-50">41-50</option>
            <option value="51+">51+</option>
        </select>
    </div>
    
    <table id="recipeTable">
        <thead>
            <tr>
                <th>Recipe Name</th>
                <th>Meal</th>
                <th>Meat</th>
                <th>Calories</th>
                <th>Fat</th>
                <th>Carbs</th>
                <th>Protein</th>
                <th>Method</th>
                <th>Minutes</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody>
            <!-- Recipe rows will be dynamically inserted here -->
        </tbody>
    </table>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        let recipes = [];
        const tableBody = document.querySelector('#recipeTable tbody');
        const searchInput = document.getElementById('searchInput');
        const mealFilter = document.getElementById('mealFilter');
        const meatFilter = document.getElementById('meatFilter');
        const calorieFilter = document.getElementById('calorieFilter');
        const fatFilter = document.getElementById('fatFilter');
        const carbFilter = document.getElementById('carbFilter');
        const proteinFilter = document.getElementById('proteinFilter');
        const timeFilter = document.getElementById('timeFilter');

        // Fetch recipes from Supabase
        fetchRecipes();

        // Add event listeners to filters
        searchInput.addEventListener('input', filterRecipes);
        mealFilter.addEventListener('change', filterRecipes);
        meatFilter.addEventListener('change', filterRecipes);
        calorieFilter.addEventListener('change', filterRecipes);
        fatFilter.addEventListener('change', filterRecipes);
        carbFilter.addEventListener('change', filterRecipes);
        proteinFilter.addEventListener('change', filterRecipes);
        timeFilter.addEventListener('change', filterRecipes);

        async function fetchRecipes() {
            try {
                const { data, error } = await supabase
                    .from('recipes')
                    .select('*');
                
                if (error) throw error;
                
                recipes = data;
                displayRecipes(recipes);
            } catch (error) {
                console.error('Error fetching recipes:', error);
            }
        }

        function displayRecipes(recipesToShow) {
            tableBody.innerHTML = '';
            recipesToShow.forEach(recipe => {
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td>${recipe.name}</td>
                    <td>${recipe.meal}</td>
                    <td>${recipe.meat}</td>
                    <td>${recipe.calories}</td>
                    <td>${recipe.fat}</td>
                    <td>${recipe.carbs}</td>
                    <td>${recipe.protein}</td>
                    <td>${recipe.method}</td>
                    <td>${recipe.minutes}</td>
                    <td><a href="${recipe.link}" target="_blank">View</a></td>
                `;
            });
        }

        function filterRecipes() {
            const searchTerm = searchInput.value.toLowerCase();
            const selectedMeals = Array.from(mealFilter.selectedOptions).map(option => option.value);
            const selectedMeats = Array.from(meatFilter.selectedOptions).map(option => option.value);
            const selectedCalories = calorieFilter.value;
            const selectedFat = fatFilter.value;
            const selectedCarbs = carbFilter.value;
            const selectedProtein = proteinFilter.value;
            const selectedTime = timeFilter.value;

            const filteredRecipes = recipes.filter(recipe => {
                const matchesSearch = recipe.name.toLowerCase().includes(searchTerm);
                const matchesMeal = selectedMeals.length === 0 || selectedMeals.some(meal => recipe.meal.includes(meal));
                const matchesMeat = selectedMeats.length === 0 || selectedMeats.some(meat => recipe.meat.includes(meat));
                const matchesCalories = !selectedCalories || checkRange(recipe.calories, selectedCalories);
                const matchesFat = !selectedFat || checkRange(recipe.fat, selectedFat);
                const matchesCarbs = !selectedCarbs || checkRange(recipe.carbs, selectedCarbs);
                const matchesProtein = !selectedProtein || checkRange(recipe.protein, selectedProtein);
                const matchesTime = !selectedTime || checkTimeRange(recipe.minutes, selectedTime);

                return matchesSearch && matchesMeal && matchesMeat && matchesCalories && matchesFat && matchesCarbs && matchesProtein && matchesTime;
            });

            displayRecipes(filteredRecipes);
        }

        function checkRange(value, range) {
            const [min, max] = range.split('-').map(Number);
            if (isNaN(min)) return value <= max;
            if (isNaN(max)) return value >= min;
            return value >= min && value <= max;
        }

        function checkTimeRange(minutes, range) {
            const [min, max] = range.split('-').map(Number);
            if (range === '51+') return minutes >= 51;
            return minutes >= min && minutes <= max;
        }
    });
    </script>
</body>
</html>
