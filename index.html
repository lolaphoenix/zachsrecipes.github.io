<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Finder</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .filter { margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #f2f2f2; }
        .checkbox-group { margin-bottom: 10px; }
    </style>
</head>
<body>
    <h1>Recipe Finder</h1>
    <div class="filter">
        <input type="text" id="search" placeholder="Search by Recipe Name" onkeyup="filterRecipes()">
    </div>
    
    <!-- Filter Settings -->
    <div class="filter-settings">
        <h3>Filter by:</h3>
        <div class="checkbox-group">
            <h4>Meal:</h4>
            <label><input type="checkbox" value="Breakfast" onchange="filterRecipes()"> Breakfast</label>
            <label><input type="checkbox" value="Lunch" onchange="filterRecipes()"> Lunch</label>
            <label><input type="checkbox" value="Dinner" onchange="filterRecipes()"> Dinner</label>
            <label><input type="checkbox" value="Appetizer/Side" onchange="filterRecipes()"> Appetizer/Side</label>
            <label><input type="checkbox" value="Dessert" onchange="filterRecipes()"> Dessert</label>
            <label><input type="checkbox" value="Bento Box" onchange="filterRecipes()"> Bento Box</label>
        </div>

        <!-- Cooking Time Filter as Dropdown -->
        <div class='checkbox-group'>
            <h4>Cooking Time:</h4>
            <select id='cookingTimeFilter' onchange='filterRecipes()'>
                <option value=''>Select Cooking Time Range...</option>
                <option value='20'>Up to 20 minutes</option>
                <option value='30'>21-30 minutes</option>
                <option value='40'>31-40 minutes</option>
                <option value='50'>41-50 minutes</option>
                <option value='60'>50+ minutes</option>
            </select>
        </div>

        <!-- Additional filters can be added here -->
    </div>

    <table id="recipeTable">
        <thead>
            <tr>
                <th>Recipe Name</th>
                <th>Meal</th>
                <th>Calories</th>
                <th>Fat</th>
                <th>Carbs</th>
                <th>Protein</th>
                <th>Method</th>
                <th>Cooking Time</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

    <script>
        // Load recipes from the JSON file
        fetch('recipes.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                const tableBody = document.getElementById('tableBody');
                window.recipesData = data; // Store the data globally for filtering

                data.forEach(recipe => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${recipe.RecipeName}</td>
                        <td>${recipe.Meal}</td>
                        <td>${recipe.Calories}</td>
                        <td>${recipe.Fat}</td>
                        <td>${recipe.Carbs}</td>
                        <td>${recipe.Protein}</td>
                        <td>${recipe.Method}</td>
                        <td>${recipe.CookingTime}</td> <!-- This will be a number -->
                        <td><a href="${recipe.Link}" target="_blank">View Recipe</a></td>`;
                    tableBody.appendChild(row);
                });
            })
            .catch(error => console.error('Error loading recipes:', error));

        // Helper function to check if cooking time matches the selected range
        function matchesCookingTime(cookingTimeValue, selectedCookingTime) {
            const cookingTime = parseInt(cookingTimeValue);
            switch (parseInt(selectedCookingTime)) {
                case 20: return cookingTime <= 20;
                case 30: return cookingTime > 20 && cookingTime <= 30;
                case 40: return cookingTime > 30 && cookingTime <= 40;
                case 50: return cookingTime > 40 && cookingTime <= 50;
                case 60: return cookingTime > 50;
                default: return true; // No filter applied
            }
        }

        // Filter function
        function filterRecipes() {
            const searchValue = document.getElementById('search').value.toLowerCase();
            const rows = document.querySelectorAll('#recipeTable tbody tr');

            // Get selected cooking time filter from dropdown
            const selectedCookingTime = document.getElementById('cookingTimeFilter').value;

            rows.forEach(row => {
                const recipeName = row.cells[0].textContent.toLowerCase();
                
                // Get the cooking time value from the table cell
                const cookingTimeCellValue = row.cells[7].textContent;

                // Check if recipe matches all criteria
                const cookingTimeMatch = !selectedCookingTime || matchesCookingTime(cookingTimeCellValue, selectedCookingTime);

                // Show row if it matches all criteria
                row.style.display = (matchesSearch && mealMatch && calorieMatch && fatMatch && carbMatch && proteinMatch && cookingTimeMatch) ? '' : 'none';
            });
        }
    </script>

</body>
</html>