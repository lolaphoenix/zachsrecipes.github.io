<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

<script>
// Initialize Supabase client
const supabase = supabase.createClient('https://smftecfffubvgnxfdhyk.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNtZnRlY2ZmZnVidmdueGZkaHlrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzI3OTMzMzgsImV4cCI6MjA0ODM2OTMzOH0.e_3jDB4acpZkY1BQReCeb5RTmfvBZYbAb2GxbaKAA1o');

// Fetch recipes from Supabase
async function fetchRecipes() {
    try {
        const { data: recipes, error } = await supabase
            .from('recipes')
            .select('*');

        if (error) throw error;

        const tableBody = document.getElementById('tableBody');
        
        // Store the data globally for filtering
        window.recipesData = recipes;

        // Render recipes
        recipes.forEach(recipe => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${recipe.RecipeName}</td>
                <td>${recipe.Meal}</td>
                <td>${recipe.Meat}</td>
                <td>${recipe.Calories}</td>
                <td>${recipe.Fat}</td>
                <td>${recipe.Carbs}</td>
                <td>${recipe.Protein}</td>
                <td>${recipe.Method}</td>
                <td>${recipe.CookingTime}</td>
                <td><a href="${recipe.Link}" target="_blank">View Recipe</a></td>
            `;
            tableBody.appendChild(row);
        });

        // Initial filtering after load
        filterRecipes();
    } catch (error) {
        console.error('Error loading recipes:', error);
    }
}

// Call the fetch function when the page loads
document.addEventListener('DOMContentLoaded', fetchRecipes);

// The rest of your existing filtering functions remain the same
// (Keep all the existing functions like matchesCalorieRange, filterRecipes, etc. from the previous script)
</script>